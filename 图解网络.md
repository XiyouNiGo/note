# 一、基础篇

+ 应⽤层是⼯作在操作系统中的⽤户态，传输层及以下则⼯作在内核态。

+ UDP 也可以实现可靠传输，把 TCP 的特性在应⽤层上实现就可以。

+ 当传输层的数据包⼤⼩超过 MSS（TCP 最⼤报⽂段⻓度） ，就要将数据包分块。

+ 在 TCP 协议中，我们把每个分块称为⼀个 TCP 段（TCP Segment）。

+ 超⽂本是超越了普通⽂本的⽂本，它是⽂字、图⽚、视频等的混合体，最关键有超链接，能从⼀个超⽂本跳转到另外⼀个超⽂本。

+ Get ⽅法的含义是请求从服务器获取资源，这个资源可以是静态的⽂本、⻚⾯、图⽚视频等。⽽ POST ⽅法则是相反操作，它向 URI 指定的资源提交数据，数据就放在报⽂的 body ⾥。GET ⽅法就是安全且幂等的，POST方法不是。

+ HTTPS 就是在 HTTP 与 TCP 层之间增加了 SSL/TLS 安全传输层。

+ HTTP 连接建⽴相对简单， TCP 三次握⼿之后便可进⾏ HTTP的报⽂传输。⽽ HTTPS 在 TCP 三次握⼿之后，还需进⾏ SSL/TLS 的握⼿过程，才可进⼊加密报⽂传输。

+ HTTPS 协议需要向 CA（证书权威机构）申请数字证书，来保证服务器的身份是可信的。

+ HTTPS：

  + 混合加密：

    + HTTPS 采⽤的是对称加密和⾮对称加密结合的「混合加密」⽅式：
    + 在通信建⽴前采⽤⾮对称加密的⽅式交换「会话秘钥」，后续就不再使⽤⾮对称加密。
    + 在通信过程中全部使⽤对称加密的「会话秘钥」的⽅式加密明⽂数据。
    + 采⽤「混合加密」的⽅式的原因：
      对称加密只使⽤⼀个密钥，运算速度快，密钥必须保密，⽆法做到安全的密钥交换。
    + ⾮对称加密使⽤两个密钥：
    + 公钥和私钥，公钥可以任意分发⽽私钥保密，解决了密钥交换问题但速度慢。
    + 因为考虑到性能的问题，所以双⽅在加密应⽤信息时使⽤的是对称加密密钥，⽽对称加密密钥是不能被泄漏的，为了保证对称加密密钥的安全性，所以使⽤⾮对称加密的⽅式来保护对称加密密钥的协商，这个⼯作就是密钥交换算法负责的。

  + 摘要算法：

    摘要算法⽤来实现完整性，能够为数据⽣成独⼀⽆⼆的「指纹」，⽤于校验数据的完整性，解决了篡改的⻛险。

  + 数字证书：

    借助第三⽅权威机构 CA （数字证书认证机构），将服务器公钥放在数字证书（由数字证书认证机构颁发）中，只要证书是可信的，公钥就是可信的。CA的公钥已事先置入到了浏览器或操作系统中。

    

+ 私钥加密算法，又称 对称加密算法。公钥加密算法，也就是非对称加密算法。

  公钥和私钥成对出现，公开的密钥叫公钥，只有自己知道的叫私钥，用公钥加密的数据只有对应的私钥可以解密，用私钥加密的数据只有对应的公钥可以解密。

+ HTTP/2：

  + 头部压缩在客户端和服务器同时维护⼀张头信息表，所有字段都会存⼊这个表，⽣成⼀个索引号，以后就不发送同样字段了，只发送索引号。

  + ⼆进制格式 HTTP/2 不再像 HTTP/1.1 ⾥的纯⽂本形式的报⽂，⽽是全⾯采⽤了⼆进制格式，头信息和数据体都是⼆进制，并且统称为帧（frame）：头信息帧和数据帧。

  + 数据流：

    每个请求或回应的所有数据包，称为⼀个数据流（ Stream ）。每个数据流都标记着⼀个独⼀⽆⼆的编号，其中规
    定客户端发出的数据流编号为奇数， 服务器发出的数据流编号为偶数。

  + 多路复⽤：
    HTTP/2 是可以在⼀个连接中并发多个请求或回应，⽽不⽤按照顺序⼀⼀对应。

  + 服务器推送：
    HTTP/2 还在⼀定程度上改善了传统的「请求 - 应答」⼯作模式，服务不再是被动地响应，也可以主动向客户端发送消息。

  + HTTP/1.1 中的管道（ pipeline）传输中如果有⼀个请求阻塞了，那么队列后请求也统统被阻塞住了。HTTP/2 多个请求复⽤⼀个TCP连接，⼀旦发⽣丢包，就会阻塞住所有的 HTTP 请求。 

+ HTTP/3 把 HTTP 下层的 TCP 协议改成了 UDP。

+ HTTP/1.1如何优化：

  + 缓存技术：

    不含有包体的 304 Not Modified。

  + 减少重定向请求次数：
    重定向的⼯作交由代理服务器完成，就能减少 HTTP 请求次数了。

  + 合并请求：

    把多个访问⼩⽂件的请求合并成⼀个⼤的请求 当⼤资源中的某⼀个⼩资源发⽣变化后，客户端必须重新下载整个完整的⼤资源⽂件。

  + 延迟发送请求：

    只获取当前⽤户所看到的⻚⾯资源，当⽤户向下滑动⻚⾯的时候，再向服务器获取接下来的资源。

  + ⽆损压缩：

    ⽆损压缩是指资源经过压缩后，信息不被破坏，还能完全恢复到压缩前的原样。

  + 有损压缩：

    有损压缩主要将次要的数据舍弃，牺牲⼀些质量来减少数据量、提⾼压缩⽐。

# 三、TCP篇

+ 为什么是三次握手？不是两次、四次？

  + 避免历史连接：
    如果是两次握手连接，就不能判断当前连接是否是历史连接，三次握手则可以在客户端（发送方）准备发送第三次报文时，客户端因有足够的上下文来判断当前连接是否是历史连接。
    客户端收到后可以根据自身的上下文，判断这是一个历史连接（序列号过期或超时），那么客户端就会发送 RST（RESET） 报文给服务端，表示中止这一次连接。

  + 同步双方初始序列号：

    SYN。

  + 避免资源浪费：
    如果客户端的 SYN 阻塞了，重复发送多次 SYN 报文，那么服务器在收到请求后就会建立多个冗余的无效链接，造成不必要的资源浪费。

